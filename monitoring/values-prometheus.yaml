# Configuration Prometheus optimisée pour AWS (budget réduit)

# Désactiver AlertManager pour économiser des ressources
alertmanager:
  enabled: false

# Désactiver Node Exporter si pas nécessaire
nodeExporter:
  enabled: true
  resources:
    limits:
      cpu: 100m
      memory: 64Mi
    requests:
      cpu: 50m
      memory: 32Mi

# Désactiver Pushgateway
pushgateway:
  enabled: false

# Configuration du serveur Prometheus
server:
  service:
    type: NodePort
    nodePort: 30900
  
  # ⚠️ PERSISTANCE DÉSACTIVÉE pour économiser
  persistentVolume:
    enabled: false
  
  # Ressources minimales
  resources:
    limits:
      cpu: 500m
      memory: 512Mi
    requests:
      cpu: 250m
      memory: 256Mi
  
  # Rétention réduite (7 jours)
  retention: "7d"

# Configuration minimale
serverFiles:
  prometheus.yml:
    scrape_configs:
      - job_name: 'prometheus'
        static_configs:
          - targets: ['localhost:9090']
      
      - job_name: 'kubernetes-nodes'
        kubernetes_sd_configs:
          - role: node
        relabel_configs:
          - action: labelmap
            regex: __meta_kubernetes_node_label_(.+)